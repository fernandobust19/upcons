<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Página Web</title>

    <!-- Carga el componente <model-viewer> de Google -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.5.0/model-viewer.min.js"></script>
    <!-- Carga de Google Fonts (Orbitron) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Orbitron:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
        }

        /* --- Estilos para el Header y Título Principal --- */
        .page-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .main-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem; /* Tamaño ajustado */
            color: #333;
            margin: 0;
            font-weight: 700; /* Negrilla */
            letter-spacing: 2px;
            /* Sombra sutil para un efecto elegante */
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.15);
            animation: fadeInGlow 1.5s ease-out 0.5s forwards;
            opacity: 0; /* Inicia invisible */
        }

        @keyframes fadeInGlow {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Contenedor principal que usa Flexbox para el diseño */
        .main-container {
            display: flex;
            flex-wrap: wrap; /* Permite que los elementos se apilen en pantallas pequeñas */
            gap: 20px; /* Espacio entre el visor y el texto */
            align-items: center;
        }
        /* Contenedor para la imagen estática */
        .image-container {
            flex: 1; /* Ocupa el espacio disponible */
            min-width: 300px; /* Ancho mínimo para evitar que se encoja demasiado */
            max-height: 60vh;
        }
        .static-image {
            width: 100%;
            height: auto;
            border-radius: 12px;
            object-fit: cover;
        }
        /* Contenedor para el texto */
        .text-container {
            flex: 1;
            min-width: 300px;
        }
        .text-container h1 {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem; /* Tamaño más pequeño */
            color: #6a4a9c; /* Un morado elegante y más sutil */
            margin-bottom: 15px;
            line-height: 1.3;
        }
        .text-container p {
            font-family: 'Lato', sans-serif; /* Fuente más elegante y legible */
            font-size: 1.1rem; /* Tamaño ligeramente mayor */
            line-height: 1.7; /* Mayor espacio entre líneas para facilitar la lectura */
            color: #444; /* Un gris oscuro que es más suave que el negro puro */
        }
        /* Estilos para el visor del modelo (ahora en el modal) */
        model-viewer {
            width: 100%;
            height: 100%;
            --poster-color: transparent; /* Fondo transparente mientras carga */
            /* Estilo para la barra de progreso */
            --progress-bar-color: #00f2ff;
            border-radius: 12px;
        }

        /* --- Estilos para el Overlay de Carga del 3D --- */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 12px; /* Coincide con el visor */
            transition: opacity 0.3s ease;
        }

        /* Clase para desvanecer el overlay de carga */
        .loading-overlay.hide {
            opacity: 0;
            pointer-events: none; /* ¡Esta es la clave! Ignora los clics en el overlay oculto */
        }

        .loading-percentage {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            color: #8a2be2;
            font-weight: bold;
        }

        /* --- Estilos para el botón y el panel de características --- */

        /* Contenedor para el botón */
        .features-button-container {
            display: flex;
            margin-top: 20px;
            gap: 20px; /* Espacio entre botones */
            flex-wrap: wrap; /* Para que se ajusten en móviles */
            justify-content: center; /* Centra los botones si se envuelven */
        }

        /* Estilo del botón de características */
        .features-button {
            position: relative; /* Necesario para el texto superpuesto */
            width: 100px; /* Tamaño reducido */
            height: 100px; /* Tamaño reducido */
            border-radius: 50%;
            border: none;
            padding: 5px; /* Pequeño padding para evitar que el texto toque los bordes */
            display: flex; /* Para centrar el texto vertical y horizontalmente */
            align-items: center;
            justify-content: center;
            text-align: center;
            /* Nuevos colores más vibrantes e "inteligentes" */
            background: linear-gradient(45deg, #00f2ff, #8a2be2, #ff00ff);
            color: white;
            font-size: 13px; /* Fuente ajustada para que quepa el texto */
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
            animation: pulse-glow-smart 4s infinite ease-in-out;
        }

        /* Animación de pulso para el brillo del botón */
        @keyframes pulse-glow-smart {
            0%, 100% {
                box-shadow: 0 0 25px 5px rgba(0, 242, 255, 0.5), 0 0 35px 15px rgba(255, 0, 255, 0.3);
            }
            50% {
                box-shadow: 0 0 35px 10px rgba(138, 43, 226, 0.5), 0 0 45px 20px rgba(0, 242, 255, 0.3);
            }
        }

        .features-button:hover {
            transform: scale(1.05);
        }

        /* Panel de detalles, oculto por defecto */
        /* --- Estilos Genéricos para Modales --- */
        .modal-overlay {
            position: fixed; /* Se superpone a todo */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); /* Fondo oscuro semitransparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0; /* Oculto por defecto */
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            position: relative;
            width: 90%;
            background-color: #fff;
            border-radius: 15px;
            padding: 20px;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* Estilos específicos para el modal 3D */
        .modal-content.modal-3d {
            width: 80%;
            height: 80%;
            max-width: 900px;
        }
        /* Estilos específicos para el modal de características */
        .modal-content.modal-features {
            max-width: 600px;
        }

        /* --- Estilos para Subtítulos Elegantes en Modales --- */
        .modal-content h2 {
            font-family: 'Playfair Display', serif;
            text-align: center;
            font-size: 2rem;
            animation: subtle-glow 6s infinite alternate;
        }

        .modal-content h2::first-letter {
            font-size: 1.2em;
            color: #8a2be2;
        }

        @keyframes subtle-glow {
            from { text-shadow: 0 0 7px rgba(0, 242, 255, 0.7); }
            to { text-shadow: 0 0 7px rgba(255, 0, 255, 0.7); }
        }


        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #333;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }

        .modal-image {
            width: 100%;
            height: auto;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        /* Estilos para la lista de medidas en el modal */
        .measures-list {
            list-style-type: none;
            padding-left: 0;
        }
        .measures-list li {
            background-color: #f0f0f0;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 5px;
            border-left: 4px solid #8a2be2;
        }

        /* Estilos para la lista de características */
        .features-list {
            list-style-type: none;
            padding-left: 0;
        }
        .features-list li {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .features-list li::before {
            content: '✔'; /* Icono de check */
            color: #28a745; /* Verde para el check */
            margin-right: 10px;
            font-weight: bold;
        }

        /* Efecto de resaltado para palabras clave */
        .features-list strong {
            color: #333;
            text-shadow: 0 0 4px rgba(138, 43, 226, 0.4);
            transition: text-shadow 0.3s ease;
        }

        /* --- Estilos para la animación de aparición de texto --- */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .reveal-item {
            opacity: 0; /* Inicia invisible */
        }

        .reveal-item.animate {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        /* --- Nuevos Estilos para la Lista de Precios --- */
        .pricing-section {
            padding: 40px 20px;
            background-color: #f9f9f9; /* Un fondo suave para la sección */
        }

        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            margin-bottom: 30px;
            text-align: center;
            color: #333;
        }

        .price-list {
            max-width: 800px;
            margin: 0 auto;
            list-style: none;
            padding: 0;
        }

        .price-item {
            display: flex;
            align-items: center;
            gap: 20px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            padding: 15px 20px;
            margin-bottom: 15px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .price-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
        }

        .price-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 10px;
        }

        .price-item-info {
            flex-grow: 1;
        }

        .price-item-info h4 {
            margin: 0 0 5px 0;
            font-size: 1.1rem;
        }

        .price-item-info p {
            margin: 0;
            color: #555;
            font-size: 0.9rem;
        }

        .price-item-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #8a2be2;
            white-space: nowrap;
        }

        .cta-button {
            display: block;
            max-width: 400px;
            margin: 40px auto 0 auto;
            padding: 15px;
            background: linear-gradient(45deg, #8a2be2, #ff00ff);
            color: white;
            text-align: center;
            text-decoration: none;
            font-weight: bold;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .cta-button:hover {
            background: linear-gradient(45deg, #ff00ff, #8a2be2);
        }

    </style>
</head>
<body>
    <header class="page-header">
        <h1 class="main-title">TEJA ESPAÑOLA PVC</h1>
    </header>
    <div class="main-container">
        <div class="image-container">
            <!-- Imagen estática que reemplaza al visor 3D -->
            <img src="teja.png" alt="Teja española de PVC" class="static-image">
        </div>
        <div class="text-container">
            <h1>Un Techo con Historia, una Solución del Futuro.</h1>
            <p>La apariencia icónica de la teja española, ahora reinventada en PVC de alto rendimiento. Experimente la tranquilidad de un techo que protege con eficacia, resiste el paso del tiempo y conserva un aspecto impecable sin el esfuerzo del mantenimiento tradicional. Su hogar merece lo mejor: una estética que perdura y una protección superior.</p>

            <div class="features-button-container">
                <!-- Botón para mostrar características -->
                <button id="features-btn" class="features-button">Características</button>
                <!-- Nuevo botón para mostrar el visor 3D -->
                <button id="show-3d-btn" class="features-button">3D</button>
                <!-- Botón para Medidas -->
                <button id="measures-btn" class="features-button">MEDIDAS</button>
                <!-- Botón de ejemplo para Instalación -->
                <button id="install-btn" class="features-button">INSTALACIÓN</button>
            </div>
        </div>
    </div>

    <section class="pricing-section">
        <h2 class="section-title">Nuestros Productos</h2>
        <ul class="price-list">
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 6.14 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$42.90</div>
            </li>
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 5.04 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$35.00</div>
            </li>
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 4.16 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$29.20</div>
            </li>
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 3.70 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$25.90</div>
            </li>
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 3.06 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$21.45</div>
            </li>
            <li class="price-item">
                <img src="tejaventa.jpg" alt="Teja PVC" class="price-item-image">
                <div class="price-item-info"><h4>Teja española 2.40 m. X 1.05</h4><p>Fondo Naranja</p></div>
                <div class="price-item-value">$18.00</div>
            </li>
        </ul>
        <!-- Puedes cambiar el enlace de WhatsApp -->
        <a href="https://wa.me/593995986366" target="_blank" class="cta-button">Solicitar Cotización</a>
    </section>

    <!-- Ventana Modal para el Visor 3D (inicialmente oculta) -->
    <div id="modal-3d" class="modal-overlay">
        <div class="modal-content modal-3d">
            <button id="modal-close" class="modal-close-btn">&times;</button>
            <!-- El visor 3D ahora vive aquí dentro -->
            <model-viewer id="main-viewer" src="teja.glb" alt="Un modelo 3D de una teja" camera-controls auto-rotate exposure="1.2" reveal="manual">
                <!-- Overlay de carga personalizado -->
                <div class="loading-overlay" slot="progress-bar"><span class="loading-percentage">0%</span></div>
            </model-viewer>
        </div>
    </div>

    <!-- Ventana Modal para Características (inicialmente oculta) -->
    <div id="features-modal" class="modal-overlay">
        <div class="modal-content modal-features">
            <button id="features-close-btn" class="modal-close-btn">&times;</button>
            <h2>Características Principales</h2>
            <ul class="features-list">
                <li class="reveal-item"><strong>Ligereza:</strong> Son mucho más livianas que las tejas tradicionales, lo que facilita su instalación y reduce la carga sobre la estructura del techo.</li>
                <li class="reveal-item"><strong>Resistencia:</strong> Protegen eficazmente contra impactos, corrosión y rayos UV.</li>
                <li class="reveal-item"><strong>Aislamiento:</strong> Ofrecen aislamiento térmico y acústico, mejorando la eficiencia energética de su hogar.</li>
                <li class="reveal-item"><strong>Durabilidad:</strong> Su vida útil puede superar los 20 años, y algunos modelos garantizan la estabilidad del color por más de una década.</li>
                <li class="reveal-item"><strong>Bajo Mantenimiento:</strong> Su superficie repele la suciedad y no requiere cuidados especiales.</li>
                <li class="reveal-item"><strong>Impermeabilidad Total:</strong> Son completamente impermeables, evitando filtraciones de humedad.</li>
                <li class="reveal-item"><strong>Instalación Sencilla:</strong> Su manejo es fácil y pueden ser instaladas sobre estructuras de madera o metal.</li>
            </ul>
        </div>
    </div>

    <!-- Ventana Modal para Medidas (inicialmente oculta) -->
    <div id="measures-modal" class="modal-overlay">
        <div class="modal-content modal-features">
            <button id="measures-close-btn" class="modal-close-btn">&times;</button>
            <h2>Medidas Disponibles</h2>
            <p class="reveal-item">Nuestras tejas se ofrecen en una variedad de longitudes para adaptarse a diferentes necesidades de construcción y minimizar los cortes y desperdicios:</p>
            <ul class="measures-list">
                <li class="reveal-item">Teja española 6.14 m. X 1.05</li>
                <li class="reveal-item">Teja española 5.04 m. X 1.05</li>
                <li class="reveal-item">Teja española 4.16 m. X 1.05</li>
                <li class="reveal-item">Teja española 3.70 m. X 1.05</li>
                <li class="reveal-item">Teja española 3.06 m. X 1.05</li>
                <li class="reveal-item">Teja española 2.40 m. X 1.05</li>
            </ul>
            <p class="reveal-item"><strong>Nota:</strong> Todas las planchas tienen un ancho total de 1.05 metros y un espesor de 2.5 mm. El ancho útil es de aproximadamente 0.96 metros, después de considerar el solape para la instalación.</p>
        </div>
    </div>

    <!-- Ventana Modal para Instalación (inicialmente oculta) -->
    <div id="install-modal" class="modal-overlay">
        <div class="modal-content modal-features">
            <button id="install-close-btn" class="modal-close-btn">&times;</button>
            <h2>Instalación de la Cubierta</h2>
            <img src="instalacion.jpg" alt="Proceso de instalación de tejas de PVC" class="modal-image">
            <p class="reveal-item">La instalación de la cubierta comienza una vez que la estructura principal de columnas y vigas está firmemente montada. Esta fase se centra en el sistema de soporte y la fijación de las tejas para proteger el área de la intemperie.</p>
            <ul class="features-list">
                <li class="reveal-item"><strong>Montaje de las correas:</strong> Las correas metálicas se instalan sobre las vigas principales. Estas piezas horizontales son cruciales, ya que forman la base directa para la cubierta y distribuyen el peso hacia la estructura.</li>
                <li class="reveal-item"><strong>Preparación de la cubierta:</strong> Se procede a la colocación de las tejas sobre las correas. La instalación debe empezar en la parte más baja del techo y avanzar hacia la cumbrera (la parte más alta), superponiendo las piezas para garantizar una correcta evacuación del agua.</li>
                <li class="reveal-item"><strong>Fijación de la cubierta:</strong> Cada teja o lámina se debe fijar de manera segura a las correas utilizando tornillos o ganchos adecuados, especialmente en áreas propensas a vientos fuertes. Se presta especial atención al sellado de los puntos de unión para asegurar una protección completa contra filtraciones.</li>
            </ul>
        </div>
    </div>

    <script>
        // --- Lógica para el contador de carga del 3D ---
        const modelViewer = document.querySelector('#main-viewer');
        const loadingPercentage = document.querySelector('.loading-percentage');

        if (modelViewer && loadingPercentage) {
            const loadingOverlay = modelViewer.querySelector('.loading-overlay');

            modelViewer.addEventListener('progress', (event) => {
                // Calcula el porcentaje y lo muestra en el span
                const percentage = Math.round(event.detail.totalProgress * 100);
                loadingPercentage.textContent = `${percentage}%`;

                // Cuando la carga se completa, añade la clase para desvanecer el overlay
                if (percentage === 100) {
                    loadingOverlay.classList.add('hide');
                }
            });

            // Nos aseguramos de resetear el overlay cuando el modal se abre de nuevo
            modelViewer.addEventListener('poster-dismissed', () => {
                loadingOverlay.classList.remove('hide');
                loadingPercentage.textContent = '0%';
            });

            // El evento 'load' es más fiable para saber cuándo la carga ha terminado realmente
            modelViewer.addEventListener('load', () => {
                loadingOverlay.classList.add('hide');
            });
        }

        // Función genérica para controlar los modales
        function setupModal(buttonId, modalId, closeButtonId) {
            let observer; // Variable para guardar el Intersection Observer
            const modelViewer = document.querySelector('#main-viewer'); // Seleccionamos el visor 3D
            const openButton = document.getElementById(buttonId);
            const modal = document.getElementById(modalId);
            const closeButton = document.getElementById(closeButtonId);

            // Abrir el modal
            openButton.addEventListener('click', () => {
                // Hacemos visible el modal
                modal.classList.add('visible');

                // --- Nueva Lógica con Intersection Observer ---
                // Opciones para el observer: se activa cuando el 20% del elemento es visible
                const options = {
                    root: modal.querySelector('.modal-content'), // Observa el scroll dentro del modal
                    rootMargin: '0px',
                    threshold: 0.2
                };

                observer = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        // Si el elemento está en la pantalla
                        if (entry.isIntersecting) {
                            entry.target.classList.add('animate'); // Añade la clase para animar
                            observer.unobserve(entry.target); // Deja de observar este elemento
                        }
                    });
                }, options);

                // Le decimos al observer qué elementos vigilar
                const itemsToReveal = modal.querySelectorAll('.reveal-item');
                itemsToReveal.forEach(item => observer.observe(item));

                // --- ¡ESTA ES LA PARTE CLAVE! ---
                // Si estamos abriendo el modal 3D, le decimos al visor que se muestre.
                if (modal.id === 'modal-3d' && modelViewer) {
                    // Esto activa la carga y renderizado del modelo.
                    modelViewer.dismissPoster();
                }
            });

            const closeModal = () => {
                modal.classList.remove('visible');

                // Resetea la animación al cerrar
                const itemsToReveal = modal.querySelectorAll('.reveal-item');
                itemsToReveal.forEach(item => {
                    item.classList.remove('animate');
                    item.style.animationDelay = ''; // Limpia el retraso
                });

                // Desconecta el observer para limpiar recursos
                if (observer) {
                    observer.disconnect();
                }

                if (modal.id === 'modal-3d' && modelViewer) {
                    modelViewer.showPoster();
                }
            };

            // Solo añadir los listeners para cerrar si el botón de cierre existe
            if (closeButton) {
                // Cerrar el modal con el botón 'X'
                closeButton.addEventListener('click', () => {
                    closeModal();
                });
            }

            // Cerrar el modal al hacer clic en el fondo oscuro
            modal.addEventListener('click', (event) => {
                if (event.target === modal) {
                    closeModal();
                }
            });
        }

        // Configurar el modal de Características
        setupModal('features-btn', 'features-modal', 'features-close-btn');

        // Configurar el modal 3D
        setupModal('show-3d-btn', 'modal-3d', 'modal-close');

        // Configurar el modal de Medidas
        setupModal('measures-btn', 'measures-modal', 'measures-close-btn');

        // Configurar el modal de Instalación (actualmente no hace nada)
        setupModal('install-btn', 'install-modal', 'install-close-btn');
    </script>
</body>
</html>